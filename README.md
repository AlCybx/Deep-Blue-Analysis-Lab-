# Deep-Blue-Analysis-Lab-

## Objective

The Deep Blue analysis Lab is a project aimed and establish in a controlled environment for simulating and detecting cyber attacks. For this lab we'll need to use DeepBlueCLI (via PowerShell as Admin) to quickly identify important activities within the exported log files in this folder (Security.evtx and System.evtx). Some questions will require manual analysis, using Event Viewer to create custom filters to identify specific activities

### Tools Used

- DeepBlueCLI.
- Powershell.
- Event Viewer.

## Scenario
A Windows workstation was recently compromised, and evidence suggests it was an attack against internet-facing RDP, then Meterpreter was deployed to conduct 'Actions on Objectives'. Can you verify these findings?

You have been provided with the Security.evtx and System.evtx log exports from the compromised system - you should analyze these, NOT the Windows logs generated by the lab machine (when using DeepBlueCLI ensure you're providing the path to these files, stored inside \Desktop\Investigation\.

* Question 1
# Using DeepBlueCLI, investigate the recovered Security log (Security.evtx). Which user account ran GoogleUpdate.exe?
To analyze the retrieved Security log (Security.evtx) and identify the user account associated with the execution of GoogleUpdate.exe, launch Windows PowerShell and locate the "DeepBlue.ps1" file. Once located, execute the command ".\DeepBlue.ps1 ..\Security.evtx" to see the security logs for the investigation.
<img width="1132" alt="Screenshot 2024-03-17 at 21 39 06" src="https://github.com/AlCybx/Deep-Blue-Analysis-Lab-/assets/161755166/81333497-7b67-409f-836e-d3a21ff59fa5">

Now, we can navigate through to locate the user who executed the GoogleUpdate.exe account.
<img width="943" alt="Screenshot 2024-03-17 at 19 59 37" src="https://github.com/AlCybx/Deep-Blue-Analysis-Lab-/assets/161755166/dfe0459a-f520-422f-a249-51d4dd77b2b8">

* Question 2
# Using DeepBlueCLI investigate the recovered Security.evtx log. At what time is there likely evidence of Meterpreter.
Upon revisiting the PowerShell information, we can discover the timestamp evidence indicating the occurrence of Meterpreter, which was utilized at "4/10/2021 10:48:14."
<img width="910" alt="Screenshot 2024-03-17 at 20 17 42" src="https://github.com/AlCybx/Deep-Blue-Analysis-Lab-/assets/161755166/04c20187-4a2f-45b4-af95-e07d13043263">

* Question 3
# Using DeepBlueCLI investigate the recovered System.evtx log. What is the name of the suspicious service created?
Directly below the Meterpreter entry in the command line, the name of the suspiciously created service can be identified.
<img width="903" alt="Screenshot 2024-03-17 at 20 26 29" src="https://github.com/AlCybx/Deep-Blue-Analysis-Lab-/assets/161755166/499501bf-eaa8-4835-a539-2885a0e58b1d">

* Question 4
# Investigate the Security.evtx log in Event Viewer. Process creation is being audited (event ID 4688). Identify the malicious executable downloaded that was used to gain a Meterpreter reverse shell, between 10:30 and 10:50 AM on the 10th of April 2021.
To locate the malicious executable downloaded within the specified timeframe, we begin by opening Windows Event Viewer and uploading the "security" file for investigation. Once the Windows Event Viewer has loaded the file, we commence the investigation process.
<img width="1414" alt="Screenshot 2024-03-17 at 20 42 42" src="https://github.com/AlCybx/Deep-Blue-Analysis-Lab-/assets/161755166/e5771d6e-e0a6-43f3-8dc0-8d6e9a18d337">

Since we are suppose to investigate a specific pepriod of time, we use filter to narrow down our search to the time and year provided.
<img width="659" alt="Screenshot 2024-03-17 at 20 53 53" src="https://github.com/AlCybx/Deep-Blue-Analysis-Lab-/assets/161755166/082c6b8e-13c7-414d-8b0b-be494f89e5b4">

Upon closer examination, we identify the malicious executable that was utilized to establish a Meterpreter reverse shell.
<img width="888" alt="Screenshot 2024-03-17 at 21 01 46" src="https://github.com/AlCybx/Deep-Blue-Analysis-Lab-/assets/161755166/de3a17a3-ae87-4e32-a57a-70863b79ab29">

* Question 5
# It's also believed that an additional account was created to ensure persistence between 11:25 AM and 11:40 AM on the 10th April 2021. What was the command line used to create this account? (Make sure you've found the right account!)
By revisiting our timeline filter and examining the specified time frame for the creation of the new account, we can observe the command line that was employed to establish the new account.
<img width="856" alt="Screenshot 2024-03-17 at 21 29 09" src="https://github.com/AlCybx/Deep-Blue-Analysis-Lab-/assets/161755166/b371132f-42bc-4af6-b1e8-a1cb02db2336">

* Question 6
# What two local groups was this new account added to?
By meticulously examining the event logs displayed in the grid, the two local groups to which the new account was added can be identified.
<img width="807" alt="Screenshot 2024-03-17 at 21 43 27" src="https://github.com/AlCybx/Deep-Blue-Analysis-Lab-/assets/161755166/65c6ad70-88c9-4f9c-a93c-cb90699b68fc">
<img width="876" alt="Screenshot 2024-03-17 at 21 42 09" src="https://github.com/AlCybx/Deep-Blue-Analysis-Lab-/assets/161755166/1a2b6ab7-0bdb-4ac9-8faf-e603eb22fd82">






